!function(){window._prof_hash={};var n="INTERNSHIP_REQUEST",e=!1,t=!1,i=!1,a=[];if(currentUserFull){_.each(currentUserFull.roles,(function(n){n.indexOf("Учебное заведение")>-1&&(e=!0),n.indexOf("Кандидат")>-1&&(i=!0),n.indexOf("Работодатель")>-1&&(t=!0)}));var o=JSON.parse(currentUserFull.externalData||"{}"),r={};if(_.has(o,"inn")&&!_.isNull(o.inn)&&(r.inn=[o.inn]),_.has(o,"kpp")&&!_.isNull(o.kpp)&&(r.kpp=[o.kpp]),_.has(o,"ogrn")&&!_.isNull(o.ogrn)&&(r.ogrn=[o.ogrn]),_.keys(r).length){var l=getCatalogData(e?"INSTITUTION":t?"EMPLOYER":i?"STUDENT":"",r);console.log(l),l.done((function(n){a=n.result.data[0]||[]}))}}function u(){return createUUID1()}window.initAllDialogProfDialog=function(){var o=$("#internship_request"),r=null,l=null;o.on("show.bs.modal",(function(n){l=$(n.relatedTarget)})),$("input[type=file]",o).on("change",(function(){r=$(this).get(0).files,$(".upload__file",o).text(r[0].name)})),o.off("submit").on("submit",(function(d){d.preventDefault();var p=function(n){var o={request_description:$("textarea",n).val(),prof_activity_code:window.__activity_area_uid,region_code:$(".js_region",n).val().toString(),application_creation_date:moment().valueOf(),publication_status:!1,prof_activity_name:window.__activity_area_name};e&&(o.id_institution=a[0]);t&&(o.id_employer=a[0]);i&&(o.id_student=a[0]);return o}(o);return(e||t)&&(p.code=l.data("profuid")||null,p.prof_name=l.data("profession")||"",function(n){var e=new FormData;return e.append("docDate",moment().format("YYYY-MM-DDT00:00:00")),e.append("docNumber",u()),e.append("docTypeCode","studDoc"),e.append("extId",u()),e.append("file",n[0]),e.append("name","Договор оферта"),e.append("nomenclature","string"),e.append("srcSystem","intern"),$.ajax({url:"/api/archive/store",data:e,contentType:!1,processData:!1,type:"POST"})}(r).done((function(e){p.file=e.extId,function(e){var t=[u(),e.request_description,e.region_code,"",e.file,e.prof_activity_code,e.code,e.id_institution||null,e.id_employer||null,e.id_student||null,"","Партнерское соглашение",null,null,"",null,null,e.application_creation_date,"","",e.region_code,e.prof_activity_name,e.prof_name,"","",!0],i={url:"//test-portal.trudvsem.ru/information/catalogprovider/api/1.2/catalog/create?code="+n+"&unique_request_identifier="+_.uniqueId("INTERNSHIP_REQUEST_")+"&data="+encodeURIComponent(JSON.stringify(t))+"&version=1.2",dataType:"json",contentType:"application/json",method:"POST"};return $.ajax(i)}(p).done((function(){o.modal("hide")}))}))),!1}))}}();