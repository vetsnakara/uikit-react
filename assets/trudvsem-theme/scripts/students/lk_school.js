!function(){var o="заключен",l=["Проведение практики","Проведение стажировки"],i="";new bft_JoinSource({sources:["_employer_source"],initHandler:function(t){var r=t._employer_source,t=JSON.parse(currentUser.externalData||"{}"),e={};_.has(t,"inn")&&!_.isNull(t.inn)&&(e.inn=[t.inn]),_.has(t,"kpp")&&!_.isNull(t.kpp)&&(e.kpp=[t.kpp]),_.has(t,"ogrn")&&!_.isNull(t.ogrn)&&(e.ogrn=[t.ogrn]);t=(t=r.url)+(-1<t.indexOf("?")?"&":"?")+"filter="+encodeURIComponent(JSON.stringify(e));return $.get(t).done(function(t){var e,a,n,t=JSON.parse(t.data);t&&t.length&&t[0]&&userDataQuery({key:"school:catalog:id",data:t[0][0]}),i=t[0][0],e={id_institution:[u()]},a={id_institution:[u()],type_of_contract:l},n={id_institution:[u()]},getCatalogData("PARTNERSHIP",e).done(function(t){t=t.result.data.length||0;$("[data-content=partners] .amount__value").text(t),$("[data-content=partners] .amount__label").text(pluralize(t,["партнер","партнера","партнеров"]))}),getCatalogData("INTERNSHIP_REQUEST",{id_employer:["EXISTS"]}).done(function(t){t=t.result.data.length||0;$("[data-content=requests] .amount__value").text(t),$("[data-content=requests] .amount__label").html(pluralize(t,["запрос","запроса","запросов"])+"<br /> от работодателя")}),getCatalogData("CONTRACT",a).done(function(t){var e=[0,0,0,0],n=(t.result.data.forEach(function(t){String(t[10]).toLocaleLowerCase()===l[0].toLocaleLowerCase()?(e[0]++,_.isArray(t[12])&&String(t[12][15]).toLowerCase()===o&&e[1]++):(e[2]++,_.isArray(t[12])&&String(t[12][15]).toLowerCase()===o&&e[3]++)}),_.max(e));e.forEach(function(t,e){var a=n?Math.round(t/n*100):0;$("div[ref=contract_type] .graph__value-"+(e+1)).css("height",a+"%"),$("div[ref=contract_type]  .graph__number-"+(e+1)).text(t)})}),getCatalogData("STUDENT",n).done(function(t){var e=[0,0,0,0],n=(e[0]=t.result.data.length,t.result.data.forEach(function(t){!0!==t[12]&&!0!==t[14]||e[1]++,t[11]&&parseInt(t[11])<parseInt(moment().format("YYYY"))&&(e[2]++,e[0]--,!0===t[16])&&e[3]++}),_.max(e));e.forEach(function(t,e){var a=n?Math.round(t/n*100):0;$("div[ref=student] .graph__value-"+(e+1)).css("height",a+"%"),$("div[ref=student]  .graph__number-"+(e+1)).text(t)})}),new bft_FilterEmulator({code:"_employer_proxy",data:{columns:r.columns,data:t,actual_date:r.actual_date,filters_values:r.filters_values,filters_settings:r.filters_settings,filters_titles:r.filters_titles,url:r.url,error:!1}})})},handler:null});var u=function(){return i}}();