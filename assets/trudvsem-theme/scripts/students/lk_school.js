!function(){var t="PARTNERSHIP",a="INTERNSHIP_REQUEST",e="CONTRACT",r="STUDENT",n="заключен",o=["Проведение практики","Проведение стажировки"],l="";new bft_JoinSource({sources:["_employer_source"],initHandler:function(u){var s=u._employer_source,c=JSON.parse(currentUser.externalData||"{}"),d={};_.has(c,"inn")&&!_.isNull(c.inn)&&(d.inn=[c.inn]),_.has(c,"kpp")&&!_.isNull(c.kpp)&&(d.kpp=[c.kpp]),_.has(c,"ogrn")&&!_.isNull(c.ogrn)&&(d.ogrn=[c.ogrn]);var f=s.url;return f=f+(f.indexOf("?")>-1?"&":"?")+"filter="+encodeURIComponent(JSON.stringify(d)),$.get(f).done((function(u){var c,d,f,g,p=JSON.parse(u.data);p&&p.length&&p[0]&&userDataQuery({key:"school:catalog:id",data:p[0][0]}),l=p[0][0],c={id_institution:[i()]},d={id_employer:["EXISTS"]},f={id_institution:[i()],type_of_contract:o},g={id_institution:[i()]},getCatalogData(t,c).done((function(t){var a=t.result.data.length||0;$("[data-content=partners] .amount__value").text(a),$("[data-content=partners] .amount__label").text(pluralize(a,["партнер","партнера","партнеров"]))})),getCatalogData(a,d).done((function(t){var a=t.result.data.length||0;$("[data-content=requests] .amount__value").text(a),$("[data-content=requests] .amount__label").html(pluralize(a,["запрос","запроса","запросов"])+"<br /> от работодателя")})),getCatalogData(e,f).done((function(t){var a=[0,0,0,0];t.result.data.forEach((function(t){String(t[10]).toLocaleLowerCase()===o[0].toLocaleLowerCase()?(a[0]++,_.isArray(t[12])&&String(t[12][15]).toLowerCase()===n&&a[1]++):(a[2]++,_.isArray(t[12])&&String(t[12][15]).toLowerCase()===n&&a[3]++)}));var e=_.max(a);a.forEach((function(t,a){var r=e?Math.round(t/e*100):0;$("div[ref=contract_type] .graph__value-"+(a+1)).css("height",r+"%"),$("div[ref=contract_type]  .graph__number-"+(a+1)).text(t)}))})),getCatalogData(r,g).done((function(t){var a=[0,0,0,0];a[0]=t.result.data.length,t.result.data.forEach((function(t){!0!==t[12]&&!0!==t[14]||a[1]++,t[11]&&parseInt(t[11])<parseInt(moment().format("YYYY"))&&(a[2]++,a[0]--,!0===t[16]&&a[3]++)}));var e=_.max(a);a.forEach((function(t,a){var r=e?Math.round(t/e*100):0;$("div[ref=student] .graph__value-"+(a+1)).css("height",r+"%"),$("div[ref=student]  .graph__number-"+(a+1)).text(t)}))})),new bft_FilterEmulator({code:"_employer_proxy",data:{columns:s.columns,data:p,actual_date:s.actual_date,filters_values:s.filters_values,filters_settings:s.filters_settings,filters_titles:s.filters_titles,url:s.url,error:!1}})}))},handler:null});var i=function(){return l}}();