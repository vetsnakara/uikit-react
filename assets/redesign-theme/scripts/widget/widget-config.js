var IS_FULL_WIDGET=-1<window.location.href.indexOf("full-widget"),IFRAME_URL=IS_FULL_WIDGET?IFRAME_FULL_URL:IFRAME_SIMPLE_URL;$(document).ready(function(){jQuery("head").append('<link href="/assets/default-theme/css/bootstrap-colorpicker.min.css" rel="stylesheet">');var c=e()+e(),o='<script src="'+LOADER_URL+'"><\/script>\n<script>\n    try {\n        (function () {\n            new VacancySearchWidget({\n                id: "%GUID%",\n                params: "%PARAMS%",\n                url: "%URL%"\n            })\n        })()\n    } catch (e) {\n        console.log(e)\n    }\n<\/script>',r=$("[data-content=code]"),i={fields:{},searchPlace:"VACANCY_NAME",publishDateType:"NOW"},t=$("[data-content=color]"),a=$("input[data-param=fields]"),n=$("select.select__control"),s=$(".text-widget__tip");function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function l(t,a,n,e){o=e,c=[];var c,o=IS_FULL_WIDGET?"":(_.each(o,function(t,a){a="_"+a+"=";_.isArray(t)?a+=t.join(","):_.isObject(t)?a+=_.keys(_.pick(t,function(t,a){return t})).join(","):a+=String(t),c.push(encodeURI(a))}),c.join("&"));a.text((a=o,t.replace("%GUID%",n).replace("%PARAMS%",a).replace("%URL%",IFRAME_URL))),$("#frame-container").attr("src",IFRAME_URL+"?"+o),e.colCount&&"three-columns"===e.colCount?s.show():s.hide()}n.on("change",function(t){var t=$(t.currentTarget),a=t.val(),t=t.data("param"),a="-1"===a?"":a;t&&(_.isEmpty(a)?i=_.omit(i,t):i[t]=a),l(o,r,c,i)}),t.colorpicker(),t.on("changeColor",function(t){var a=$(t.currentTarget),n=a.data("param"),e=t.value;e&&n&&(i[n]=String(e).slice(1),$(".input__append",a.parent()).css("background-color",t.value)),l(o,r,c,i)}),$("select[data-dic]").each(function(){var a=$(this),n=a.data("dic"),e=a.data("value")||"code",c=a.data("label")||"name";$.ajax({type:"GET",url:DICT_URL+"?code="+n,dataType:"jsonp",async:!1,crossDomain:!0}).done(function(t){t&&_.isArray(t)&&((t="ENUM_SOURCE"===n?_.filter(t,function(t){return-1===["RPORTAL","HR_SERVICE","FROM_ESIA"].indexOf(t[e])}):t).map(function(t){a.append('<option value="'+t[e]+'">'+t[c]+"</option>")}),a.selectpicker("destroy"),window.initBootstrapSelect(a))})}),a.each(function(){var t=$(this),a=t.attr("name");a&&(i.fields[a]=t.is(":checked"))}),a.on("change",function(){var t=$(this),a=t.attr("name");a&&(i.fields[a]=t.is(":checked")),l(o,r,c,i)}),$("input[data-param=colCount]").on("change",function(){i.colCount=$("input[data-param=colCount]:checked").val(),l(o,r,c,i)}),$("input[data-param=elCount], input[data-param=title]").on("keyup",function(t){var t=$(t.currentTarget),a=t.data("param"),t=("elCount"===a&&t.val(function(t){t=parseInt(t);return t<1?1:100<t?100:t}(t.val())),t.val());a&&(t?i[a]=t:i=_.omit(i,a)),l(o,r,c,i)}),new ClipboardJS('[data-action="copy"]'),l(o,r,c,i),$(window).off("message").on("message",function(t){try{var a=$("#frame-container"),n=t.originalEvent.data;a.height()!=n&&a.height(n)}catch(t){}})});