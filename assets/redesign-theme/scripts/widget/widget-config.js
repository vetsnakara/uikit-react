var IS_FULL_WIDGET=window.location.href.indexOf("full-widget")>-1,IFRAME_URL=IS_FULL_WIDGET?IFRAME_FULL_URL:IFRAME_SIMPLE_URL;$(document).ready((function(){jQuery("head").append('<link href="/assets/default-theme/css/bootstrap-colorpicker.min.css" rel="stylesheet">');var t=s()+s(),a='<script src="'+LOADER_URL+'"><\/script>\n<script>\n    try {\n        (function () {\n            new VacancySearchWidget({\n                id: "%GUID%",\n                params: "%PARAMS%",\n                url: "%URL%"\n            })\n        })()\n    } catch (e) {\n        console.log(e)\n    }\n<\/script>',n=$("[data-content=code]"),e={fields:{},searchPlace:"VACANCY_NAME",publishDateType:"NOW"},r=$("[data-content=color]"),c=$("input[data-param=fields]"),o=$("select.select__control"),i=$(".text-widget__tip");function s(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function l(t,a,n,e){var r=function(t){var a=[];return IS_FULL_WIDGET?"":(_.each(t,(function(t,n){var e="_"+n+"=";_.isArray(t)?e+=t.join(","):_.isObject(t)?e+=_.keys(_.pick(t,(function(t,a){return t}))).join(","):e+=String(t),a.push(encodeURI(e))})),a.join("&"))}(e);a.text(function(t,a,n){return t.replace("%GUID%",a).replace("%PARAMS%",n).replace("%URL%",IFRAME_URL)}(t,n,r)),$("#frame-container").attr("src",IFRAME_URL+"?"+r),e.colCount&&"three-columns"===e.colCount?i.show():i.hide()}o.on("change",(function(r){var c=$(r.currentTarget),o=c.val(),i=c.data("param");o="-1"===o?"":o,i&&(_.isEmpty(o)?e=_.omit(e,i):e[i]=o),l(a,n,t,e)})),r.colorpicker(),r.on("changeColor",(function(r){var c=$(r.currentTarget),o=c.data("param"),i=r.value;i&&o&&(e[o]=String(i).slice(1),$(".input__append",c.parent()).css("background-color",r.value)),l(a,n,t,e)})),$("select[data-dic]").each((function(){var t,a=$(this),n=a.data("dic"),e=a.data("value")||"code",r=a.data("label")||"name";(t=n,$.ajax({type:"GET",url:DICT_URL+"?code="+t,dataType:"jsonp",async:!1,crossDomain:!0})).done((function(t){t&&_.isArray(t)&&("ENUM_SOURCE"===n&&(t=_.filter(t,(function(t){return-1===["RPORTAL","HR_SERVICE","FROM_ESIA"].indexOf(t[e])}))),t.map((function(t){a.append('<option value="'+t[e]+'">'+t[r]+"</option>")})),a.selectpicker("destroy"),window.initBootstrapSelect(a))}))})),c.each((function(){var t=$(this),a=t.attr("name");a&&(e.fields[a]=t.is(":checked"))})),c.on("change",(function(){var r=$(this),c=r.attr("name");c&&(e.fields[c]=r.is(":checked")),l(a,n,t,e)})),$("input[data-param=colCount]").on("change",(function(){e.colCount=$("input[data-param=colCount]:checked").val(),l(a,n,t,e)})),$("input[data-param=elCount], input[data-param=title]").on("keyup",(function(r){var c,o,i=$(r.currentTarget),s=i.data("param");"elCount"===s&&i.val((c=i.val(),(o=parseInt(c))<1?1:o>100?100:o));var u=i.val();s&&(u?e[s]=u:e=_.omit(e,s)),l(a,n,t,e)})),new ClipboardJS('[data-action="copy"]'),l(a,n,t,e),$(window).off("message").on("message",(function(t){try{var a=$("#frame-container"),n=t.originalEvent.data;a.height()!=n&&a.height(n)}catch(t){}}))}));