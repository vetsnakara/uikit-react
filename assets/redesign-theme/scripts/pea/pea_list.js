function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(n){var i={};function a(t){var e;return(i[t]||(e=i[t]={i:t,l:!1,exports:{}},n[t].call(e.exports,e,e.exports,a),e.l=!0,e)).exports}a.m=n,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/assets/main-theme/js/",a(a.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e){function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n(a.prototype,[{key:"initialization",value:function(){if(clearInterval(this.timer),"function"!=typeof window[this.virtualSource]){if(this.errorCounter>this.maxErrors)throw new Error("Не могу получить ссылку на источник данных. Функции "+this.virtualSource+" не существует");this.errorCounter++,this.timer=setInterval(this.initialization,100)}else window[this.virtualSource](null,this.virtualSourceCallback)}},{key:"virtualSourceCallback",value:function(t){var e,n=this;this.data={columns:JSON.parse(JSON.stringify(t.columns)),data:t.data.filter(function(t){return null!==t})},this.currentPage=0,this._filtersValues=t.filters_values;for(e in this.accreditationIndexes)!function(e){n.accreditationIndexes[e]=n.data.columns.findIndex(function(t){return e===t.code},n)}(e);!0!==this.initialized&&(this._getData=t.url,this.setHandlers(),this.data.data=this.sortData(this.data.data,"reestr",this.data.columns,1),this.initialized=!0),this.render()}},{key:"render",value:function(){var d=this,l=this.structure.filter(function(t){return t.visible}),c=this.element.querySelector('[data-content="container"]'),t=this.data.data.length>this.rowsOnPage?this.currentPage*this.rowsOnPage:0,e=this.data.data.length>this.rowsOnPage?(this.currentPage+1)*this.rowsOnPage:this.data.data.length;c.innerHTML="";for(var n=t;n<e&&"break"!==function(t){if(t>=d.data.data.length)return"break";var i=d.data.data[t],a=d.rowTemplate.cloneNode(!0),t=d.isAccredited(i),e=a.querySelector('[data-content="vacancies"]'),n=["/vacancy/search?_page=0"],r=d.data.columns.findIndex(function(t){return"inn"===t.code}),o=d.data.columns.findIndex(function(t){return"regnum"===t.code}),s=(a.setAttribute("data-id",i[0]),n.push("_inn="+i[r]),n.push("_ogrn="+i[o]),e.setAttribute("href",n.join("&")),void 0);t||((s=document.createElement("div")).classList.add("content_important","content_small"),s.textContent="Аккредитация отозвана"),l.forEach(function(e){var t=d.data.columns.findIndex(function(t){return t.code===e.code}),n=a.querySelector('[data-content="cell-'+e.code+'"]');n&&0===n.children.length&&(n.textContent=i[t]),n&&0<n.children.length&&(n.children[0].textContent=i[t]),"reestr"===e.code&&s&&n.appendChild(s)},d),c.appendChild(a)}(n);n++);this.data.data.length<this.rowsOnPage?this.paginationNode.classList.add("hidden"):this.renderPagination()}},{key:"pagination",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;function a(t,e){for(var n=Array(e-t),i=0,a=t;i<n.length;)n[i++]=a++;return n}var r,o,s=[],d=[],l=["…"];return s=2<t-n-i?(r=a(1,i+1),o=a(t-n,t),s.concat(r,l,o)):a(1,t),d=t+n+i-1<e-2?(r=a(1+e-i,1+e),o=a(1+t,1+t+n),d.concat(o,l,r)):a(1+t,1+e),[].concat(s,t,d)}},{key:"renderPagination",value:function(){var t=Math.ceil(this.data.data.length/this.rowsOnPage),e=this.paginationNode.querySelector(".pagination"),n=this.pagination(this.currentPage+1,t),i=0===this.currentPage,a=this.currentPage===t-1;e.innerHTML="",e.appendChild(this.paginationPrevTemplate),this.paginationPrevTemplate.classList[i?"add":"remove"]("pagination__item_disabled");var r,o=function(t,e){var n,i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){var n;if(t)return"string"==typeof t?c(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return n&&(t=n),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw a}}}}(n);try{for(o.s();!(r=o.n()).done;){var s=r.value,d=this.paginationNumberTemplate.cloneNode(!0),l=parseInt(s,10);d.textContent=s,isNaN(l)?(d.classList.remove("pagination__item"),d.classList.add("pagination__kebab")):(d.setAttribute("data-page",l),this.currentPage+1===l&&(d.classList.remove("pagination__kebab"),d.classList.add("pagination__item","pagination__item_active"))),e.appendChild(d)}}catch(t){o.e(t)}finally{o.f()}e.appendChild(this.paginationNextTemplate),this.paginationNextTemplate.classList[a?"add":"remove"]("pagination__item_disabled"),this.paginationNode.classList.remove("hidden")}},{key:"renderDetails",value:function(t){var r=this,e=t.relatedTarget.closest("tr").getAttribute("data-id"),o=this.data.data.find(function(t){return t[0]===e}),t=this.modalNode.querySelector('[data-content="accreditation"]'),s=this.isAccredited(o);s?t.setAttribute("hidden",!0):t.removeAttribute("hidden",!0),this.data.columns.forEach(function(e){var t,n,i=r.data.columns.findIndex(function(t){return t.code===e.code}),a=r.modalNode.querySelector(".infomodal_dd_"+e.code),i=o[i]||"-";"regnum"===e.code||!1===e.visible?a.closest(".row").setAttribute("hidden",!0):"inn"===e.code?(t=r.modalNode.querySelector(".infomodal_dl_inn"),n=r.data.columns.findIndex(function(t){return"regnum"===t.code}),t&&(t.innerHTML="<b>ИНН / ОГРН</b>"),i="".concat(i," / ",o[n]||"-")):"otziv"===e.code&&s?a.classList.remove("content_important"):"otziv"===e.code&&a.classList.add("content_important"),a&&(a.textContent=i)},this)}},{key:"setHandlers",value:function(){var e=this;this.headerNodes.forEach(function(t){t.addEventListener("click",e.sortHandler)}),$(document.getElementById("pealist_modal_"+this.id)).on("show.bs.modal",this.renderDetails),this.paginationNode.addEventListener("click",this.paginationHandler)}},{key:"sortHandler",value:function(t){var e,t=t.currentTarget.querySelector("[data-column-code"),n=t.getAttribute("data-column-code");n===this.sortedCode&&(t.classList.remove(this.sortedClass),this.direction=-1*this.direction,this.sortedClass=1===this.direction?"table__sorting_up":"table__sorting_down"),n!==this.sortedCode&&((e=this.element.querySelector('.table__title [data-column-code="'+this.sortedCode+'"]'))&&e.classList.remove(this.sortedClass),this.sortedCode=n,this.direction=1,this.sortedClass="table__sorting_up"),t.classList.add(this.sortedClass),this.data.data=this.sortData(this.data.data,n,this.data.columns,this.direction),this.render()}},{key:"paginationHandler",value:function(t){var e=this,t=(t.preventDefault(),t.target.closest(".pagination__item")),n=t.classList.contains("pagination__item_next"),i=t.classList.contains("pagination__item_previous");null===t||t.classList.contains("pagination__item_disabled")||t.classList.contains("pagination__item_active")||(i&&--this.currentPage,n&&(this.currentPage+=1),n||i||(this.currentPage=parseInt(t.getAttribute("data-page")||1,10)-1),setTimeout(function(){window.scroll(0,e.element.getBoundingClientRect().top+window.scrollY-100)},150),this.render())}},{key:"isAccredited",value:function(t){var e=t[this.accreditationIndexes.date],n=t[this.accreditationIndexes.otziv],i=this.convertDate(t[this.accreditationIndexes.prodl]),t=this.convertDate(t[this.accreditationIndexes.ostanov]);return Boolean(!t&&e&&(!n||i&&n<i))}},{key:"sortData",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r="string",o=null===i?0:-1,t=t.slice();if(null===e)return t;if(null!==i){if(-1===(o=i.findIndex(function(t){return t.code===e})))return t;r=i[o].type.toLowerCase()}return t.sort(function(t,e){return!n.isAccredited(t)&&n.isAccredited(e)?1:n.isAccredited(t)&&!n.isAccredited(e)?-1:"number"!==r?t[o]>e[o]?+a:-1*a:(parseFloat(t[o],10)-parseFloat(e[o],10))*a})}},{key:"convertDate",value:function(t){var e,n,t=t.split(".");return 3!==t.length?null:(e=t[0],n=t[1]-1,t=t[2],new Date(t,n,e))}}]);var i=a;function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this,n=a;if(!(e instanceof n))throw new TypeError("Cannot call a class as a function");if(this.id=t.id||(1e8*Math.random()).toString(32).replace(".","-")+"-"+(1e8*Math.random()).toString(32).replace(".","-"),this.structure=t.structure||{},this.virtualSource=t.virtualSource||"",this.element=document.getElementById("_"+this.id),null===this.element)throw new Error("Не смог найти элемен для отрисовки. Элемент с id - "+this.id+" не существует");this.rowTemplate=document.getElementById("pealist_row_"+this.id).cloneNode(!0),this.rowTemplate.removeAttribute("id"),this.modalNode=document.getElementById("pealist_modal_"+this.id),this.paginationNode=document.getElementById("pealist_pagination_"+this.id),this.paginationNumberTemplate=document.getElementById("pealist_number_"+this.id).cloneNode(!0),this.paginationNumberTemplate.removeAttribute("id"),this.paginationPrevTemplate=this.paginationNode.querySelector(".pagination__item_previous").cloneNode(!0),this.paginationNextTemplate=this.paginationNode.querySelector(".pagination__item_next").cloneNode(!0),this.headerNodes=this.element.querySelectorAll("thead th"),this.initialized=!1,this.errorCounter=0,this.maxErrors=10,this.rowsOnPage=20,this.sortedCode=null,this.sortedDirection=1,this.sortedClass="table__sorting_up",this.currentPage=0,this.accreditationIndexes={date:null,otziv:null,prodl:null,ostanov:null},this.accreditationDateColumnIndex=null,this.accreditationDateColumnCode="date",this.revocationDateColumnIndex=null,this.revocationDateColumnCode="otziv",this.initialization=this.initialization.bind(this),this.virtualSourceCallback=this.virtualSourceCallback.bind(this),this.renderDetails=this.renderDetails.bind(this),this.sortHandler=this.sortHandler.bind(this),this.paginationHandler=this.paginationHandler.bind(this),this.initialization()}window.PEAList=i}]);